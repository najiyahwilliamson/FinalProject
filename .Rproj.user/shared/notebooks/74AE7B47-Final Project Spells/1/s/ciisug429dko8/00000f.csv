"0","library(tidyverse)"
"0","library(ggplot2)"
"0","library(kableExtra)"
"0",""
"0","data <- data %>%"
"0","  mutate(Spell.Category = case_when("
"0","    grepl(""charm|water-making spell|locking spell|general counter-spell|fire-making spell|dissendium|Human Presence Revealing Spell|lumos|protego maxima|protego totalum|Repello Inimicum"", Spell.Name, ignore.case = TRUE) ~ ""Charm"","
"0","    grepl(""curse|sectumsempra"", Spell.Name, ignore.case = TRUE) ~ ""Curse"","
"0","    grepl(""jinx|levicorpus|stunning spell"", Spell.Name, ignore.case = TRUE) ~ ""Jinx"","
"0","    grepl(""episkey|brackium emendo"", Spell.Name, ignore.case = TRUE) ~ ""Healing"","
"0","    grepl(""piertotum locomotor|snake summons spell|vera verto|incarcerous spell"","
"0","          Spell.Name, ignore.case = TRUE) ~ ""Transfiguration\nand Conjuring"","
"0","    TRUE ~ ""Other"""
"0","  )) "
"0",""
"0","#Frequency of categories"
"0","freq_cat <- data %>%"
"0","  count(Spell.Category, sort = TRUE)"
"0",""
"0","# Make character"
"0","freq_cat$Spell.Category <- as.character(freq_cat$Spell.Category)"
"0",""
"0","# All categories in desired order"
"0","all_categories <- c(""Charm"", ""Healing"", ""Curse"", ""Jinx"", ""Other"","
"0","                    ""Transfiguration\nand Conjuring"")"
"0",""
"0","# Complete missing categories (if any) and reorder"
"0","freq_cat <- freq_cat %>%"
"0","  complete(Spell.Category = all_categories, fill = list(n = 0)) %>%"
"0","  arrange(match(Spell.Category, all_categories))"
"0",""
